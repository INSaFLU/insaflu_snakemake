
Found 2 genes in ../user/references/SARS_CoV_2_COVID_19_Wuhan_Hu_1_MN908947.fasta
inputfile = orig
2 x 29903 - 29898 d
nthread = 5
stacksize: 8192 kb
generating a scoring matrix for nucleotide (dist=200) ... done
Gap Penalty = -1.53, +0.00, +0.00



Making a distance matrix ..
    1 / 2 (thread    0)
done.

Constructing a UPGMA tree (efffree=1) ... 
    0 / 2
done.

Progressive alignment 1/1... 
[Thu Jan 12 10:28:36 2023]
STEP     1 / 1 (thread    0)Finished job 32.
f9 of 24 steps (38%) done

[Thu Jan 12 10:28:36 2023]
rule makeproject:
    input: align_samples/demo_SARSCoV2_066/snippy/snps.bam
    output: projects/sars_dataset/sample_demo_SARSCoV2_066/demo_SARSCoV2_066_consensus.fasta, projects/sars_dataset/sample_demo_SARSCoV2_066/snps.depth.gz, projects/sars_dataset/sample_demo_SARSCoV2_066/snps.vcf
    jobid: 38
    reason: Missing output files: projects/sars_dataset/sample_demo_SARSCoV2_066/demo_SARSCoV2_066_consensus.fasta
    wildcards: project=sars_dataset, sample=demo_SARSCoV2_066
    resources: tmpdir=/tmp


[Thu Jan 12 10:28:36 2023]
rule makeproject:
    input: align_samples/demo_SARSCoV2_065/snippy/snps.bam
    output: projects/sars_dataset/sample_demo_SARSCoV2_065/demo_SARSCoV2_065_consensus.fasta, projects/sars_dataset/sample_demo_SARSCoV2_065/snps.depth.gz, projects/sars_dataset/sample_demo_SARSCoV2_065/snps.vcf
    jobid: 37
    reason: Missing output files: projects/sars_dataset/sample_demo_SARSCoV2_065/demo_SARSCoV2_065_consensus.fasta
    wildcards: project=sars_dataset, sample=demo_SARSCoV2_065
    resources: tmpdir=/tmp

Waiting at most 5 seconds for missing files.
Collecting files in: align_samples/demo_SARSCoV2_066/snippy/snps.depth.gz
processing file: align_samples/demo_SARSCoV2_066/snippy/snps.depth.gz
Output saved in: align_samples/demo_SARSCoV2_066/demo_SARSCoV2_066_coverage.csv
Finished...

done.

disttbfast (nuc) Version 7.313 alg=A, model=DNA200 (2), 1.53 (4.59), -0.00 (-0.00), noshift, amax=0.0
5 thread(s)


Strategy:
 FFT-NS-1 (Very fast but very rough)
 Progressive method (rough guide tree was used.)

If unsure which option to use, try 'mafft --auto input > output'.
For more information, see 'mafft --help', 'mafft --man' and the mafft page.

The default gap scoring scheme has been changed in version 7.110 (2013 Oct).
It tends to insert more gaps into gap-rich regions than previous versions.
To disable this change, add the --leavegappyregion option.

Collecting files in: align_samples/demo_SARSCoV2_065/snippy/snps.depth.gz
processing file: align_samples/demo_SARSCoV2_065/snippy/snps.depth.gz
Output saved in: align_samples/demo_SARSCoV2_065/demo_SARSCoV2_065_coverage.csv
Finished...
Checking program versions
This is medaka 1.4.4
Program    Version    Required   Pass     
bcftools   1.12       1.11       True     
bgzip      1.12       1.11       True     
minimap2   2.22       2.11       True     
samtools   1.12       1.11       True     
tabix      1.12       1.11       True     
Warning: Output align_samples/demo_SARSCoV2_069/medaka already exists, may use old results.
MissingOutputException in rule makeproject in file /home/reusebio/insaflu_snakemake/workflow/rules/make_project.smk, line 8:
Job 38  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
projects/sars_dataset/sample_demo_SARSCoV2_066/demo_SARSCoV2_066_consensus.fasta
Removing output files of failed job makeproject since they might be corrupted:
projects/sars_dataset/sample_demo_SARSCoV2_066/snps.depth.gz, projects/sars_dataset/sample_demo_SARSCoV2_066/snps.vcf
Waiting at most 5 seconds for missing files.
Aligning basecalls to draft
Removing previous index file /home/reusebio/insaflu_snakemake/results/align_samples/demo_SARSCoV2_069/medaka/ref.fasta.mmi
Removing previous index file /home/reusebio/insaflu_snakemake/results/align_samples/demo_SARSCoV2_069/medaka/ref.fasta.fai
Constructing minimap index.
[M::mm_idx_gen::0.002*0.74] collected minimizers
[M::mm_idx_gen::0.004*1.20] sorted minimizers
[M::main::0.006*1.15] loaded/built the index for 1 target sequence(s)
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 1
[M::mm_idx_stat::0.006*1.14] distinct minimizers: 5587 (99.93% are singletons); average occurrences: 1.004; average spacing: 5.332; total length: 29903
[M::main] Version: 2.22-r1101
[M::main] CMD: minimap2 -I 16G -x map-ont --MD -d /home/reusebio/insaflu_snakemake/results/align_samples/demo_SARSCoV2_069/medaka/ref.fasta.mmi /home/reusebio/insaflu_snakemake/results/align_samples/demo_SARSCoV2_069/medaka/ref.fasta
[M::main] Real time: 0.006 sec; CPU: 0.007 sec; Peak RSS: 0.004 GB
[M::main::0.002*1.35] loaded/built the index for 1 target sequence(s)
[M::mm_mapopt_update::0.002*1.31] mid_occ = 10
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 1
[M::mm_idx_stat::0.002*1.28] distinct minimizers: 5587 (99.93% are singletons); average occurrences: 1.004; average spacing: 5.332; total length: 29903
[M::worker_pipeline::4.453*2.97] mapped 143240 sequences
[M::main] Version: 2.22-r1101
[M::main] CMD: minimap2 -x map-ont --MD -t 4 -a -A 2 -B 4 -O 4,24 -E 2,1 /home/reusebio/insaflu_snakemake/results/align_samples/demo_SARSCoV2_069/medaka/ref.fasta.mmi /home/reusebio/insaflu_snakemake/results/samples/demo_SARSCoV2_069/trimmed_reads/nano_demo_SARSCoV2_069.trimmed.fastq.gz
[M::main] Real time: 4.454 sec; CPU: 13.204 sec; Peak RSS: 0.175 GB
[bam_sort_core] merging from 0 files and 4 in-memory blocks...
MissingOutputException in rule makeproject in file /home/reusebio/insaflu_snakemake/workflow/rules/make_project.smk, line 8:
Job 37  completed successfully, but some output files are missing. Missing files after 5 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
projects/sars_dataset/sample_demo_SARSCoV2_065/demo_SARSCoV2_065_consensus.fasta
Removing output files of failed job makeproject since they might be corrupted:
projects/sars_dataset/sample_demo_SARSCoV2_065/snps.depth.gz, projects/sars_dataset/sample_demo_SARSCoV2_065/snps.vcf
[Thu Jan 12 10:28:47 2023]
Finished job 24.
10 of 29 steps (34%) done
[Thu Jan 12 10:28:47 2023]
Finished job 10.
11 of 29 steps (38%) done
Removing temporary output align_samples/demo_SARSCoV2_065/snippy/snippy_align_SARS_CoV_2.fasta.
[Thu Jan 12 10:28:47 2023]
Finished job 23.
12 of 29 steps (41%) done
Running medaka consensus
[10:28:49 - Predict] Reducing threads to 2, anymore is a waste.
[10:28:49 - Predict] It looks like you are running medaka without a GPU and attempted to set a high number of threads. We have scaled this down to an optimal number. If you wish to improve performance please see https://nanoporetech.github.io/medaka/installation.html#improving-parallelism.
[10:28:49 - Predict] Setting tensorflow inter/intra-op threads to 2/1.
[10:28:49 - Predict] Processing region(s): SARS_CoV_2:0-29903
[10:28:49 - Predict] Using model: /home/reusebio/insaflu_snakemake/results/.snakemake/conda/ca58a21538bd0a4430f24681d4e87b5f_/lib/python3.8/site-packages/medaka/data/r941_min_high_g360_model.hdf5.
[10:28:49 - Predict] Processing 1 long region(s) with batching.
[10:28:49 - MdlStore] filepath /home/reusebio/insaflu_snakemake/results/.snakemake/conda/ca58a21538bd0a4430f24681d4e87b5f_/lib/python3.8/site-packages/medaka/data/r941_min_high_g360_model.hdf5
[10:28:49 - Sampler] Initializing sampler for consensus of region SARS_CoV_2:0-29903.
[10:28:49 - PWorker] Running inference for 0.0M draft bases.
[10:28:52 - Feature] Pileup counts do not span requested region, requested SARS_CoV_2:0-29903, received 28-29868.
[10:28:52 - Feature] Processed SARS_CoV_2:28.0-29868.0 (median depth 1745.0)
[10:28:52 - Sampler] Took 2.38s to make features.
[10:28:56 - PWorker] Batches in cache: 1.
[10:28:56 - PWorker] Processed 1 batches
[10:28:56 - PWorker] All done, 0 remainder regions.
[10:28:56 - Predict] Finished processing all regions.
[10:28:57 - DataIndx] Loaded 1/1 (100.00%) sample files.
[10:28:57 - DataIndx] Loaded 1/1 (100.00%) sample files.
Polished assembly written to align_samples/demo_SARSCoV2_069/medaka/consensus.fasta, have a nice day.
[Thu Jan 12 10:28:58 2023]
Finished job 28.
13 of 29 steps (45%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: ../.snakemake/log/2023-01-12T102817.627134.snakemake.log
